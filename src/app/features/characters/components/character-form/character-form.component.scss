::ng-deep .character-form-dialog {
  width: 90vw;
  max-width: 600px;
  min-width: 400px;

  .p-dialog-header {
    background: var(--p-surface-100);
    border-bottom: 1px solid var(--p-surface-border);
    padding: 1.5rem;

    .p-dialog-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--p-text-color);
    }
  }

  .p-dialog-content {
    padding: 0;
    background: var(--p-surface-ground);
  }

  .p-dialog-footer {
    display: none; // We handle buttons in the form
  }
}

.character-form {
  padding: 1.5rem;
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  position: relative;

  .form-field {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;

    .field-label {
      font-weight: 500;
      color: var(--p-text-color);
      font-size: 0.875rem;
      letter-spacing: 0.025em;
    }

    .field-error {
      margin-top: 0.25rem;

      ::ng-deep {
        .p-message {
          margin: 0;
          padding: 0.375rem 0.5rem;
          font-size: 0.75rem;

          .p-message-text {
            font-size: 0.75rem;
          }
        }
      }
    }

    // Input styling
    ::ng-deep {
      .p-inputtext,
      .p-dropdown,
      .p-multiselect,
      .p-inputnumber {
        width: 100%;

        &.ng-invalid.ng-touched,
        &.ng-invalid.ng-dirty {
          border-color: var(--p-red-500);
          box-shadow: 0 0 0 0.1rem rgba(239, 68, 68, 0.2);
        }
      }

      .p-dropdown {
        .p-dropdown-label {
          padding: 0.75rem;
        }

        &.p-disabled {
          opacity: 0.6;
          cursor: not-allowed;

          .p-dropdown-trigger {
            cursor: not-allowed;
          }
        }
      }

      .p-multiselect {
        .p-multiselect-label {
          padding: 0.75rem;
        }

        .p-multiselect-token {
          background: var(--p-primary-100);
          color: var(--p-primary-700);
          border-radius: var(--p-border-radius-sm);
          padding: 0.25rem 0.5rem;
          margin: 0.125rem;
          font-size: 0.75rem;
          font-weight: 500;

          .p-multiselect-token-icon {
            margin-left: 0.25rem;
            color: var(--p-primary-600);
          }
        }
      }

      .p-inputnumber {
        .p-inputnumber-input {
          text-align: center;
        }

        .p-inputnumber-button {
          width: 2rem;

          &.p-inputnumber-button-up {
            border-top-right-radius: var(--p-border-radius-md);
            border-bottom-right-radius: var(--p-border-radius-md);
          }

          &.p-inputnumber-button-down {
            border-top-left-radius: var(--p-border-radius-md);
            border-bottom-left-radius: var(--p-border-radius-md);
          }
        }
      }
    }
  }

  .api-validation-error {
    margin: 1rem 0;

    ::ng-deep {
      .p-message {
        margin: 0;
        padding: 0.75rem 1rem;
        font-size: 0.875rem;
        border-radius: var(--p-border-radius-md);

        .p-message-text {
          font-size: 0.875rem;
          line-height: 1.4;
        }

        .p-message-icon {
          font-size: 1rem;
          margin-right: 0.5rem;
        }
      }
    }
  }

  .form-actions {
    display: flex;
    justify-content: flex-end;
    gap: 0.75rem;
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid var(--p-surface-border);

    ::ng-deep {
      .p-button {
        padding: 0.75rem 1.5rem;
        font-weight: 500;
        font-size: 0.875rem;
        border-radius: var(--p-border-radius-md);
        transition: all 0.2s;

        &.p-button-secondary {
          &.p-button-text {
            color: var(--p-text-color-secondary);

            &:hover {
              background: var(--p-surface-hover);
              color: var(--p-text-color);
            }
          }
        }

        &.p-button-primary {
          background: var(--p-primary-500);
          border-color: var(--p-primary-500);

          &:hover {
            background: var(--p-primary-600);
            border-color: var(--p-primary-600);
          }

          &:disabled {
            opacity: 0.6;
            cursor: not-allowed;
          }
        }
      }
    }
  }

  .form-loading {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(255, 255, 255, 0.9);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    border-radius: var(--p-border-radius-md);
    z-index: 10;

    i {
      font-size: 1.5rem;
      color: var(--p-primary-500);
    }

    span {
      color: var(--p-text-color);
      font-weight: 500;
      font-size: 0.875rem;
    }
  }
}

// Enhanced Profession Selector Styling
.field-hint {
  display: block;
  font-size: 0.75rem;
  font-weight: 400;
  color: var(--p-text-color-secondary);
  margin-top: 0.25rem;
}

::ng-deep .profession-multiselect {
  .p-multiselect-label-container {
    .p-multiselect-label {
      padding: 0.5rem 0.75rem;
    }
  }
}

// Profession group header
.profession-group-header {
  display: flex;
  align-items: center;
  padding: 0.75rem 1rem;
  background: var(--p-surface-50);
  border-bottom: 1px solid var(--p-surface-border);

  .group-type-badge {
    font-weight: 600;
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    padding: 0.25rem 0.75rem;
    border-radius: var(--p-border-radius-sm);

    &.gathering {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
      box-shadow: 0 2px 4px rgba(16, 185, 129, 0.2);
    }

    &.crafting {
      background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
      color: white;
      box-shadow: 0 2px 4px rgba(245, 158, 11, 0.2);
    }
  }
}

// Individual profession option
.profession-option {
  display: flex;
  align-items: flex-start;
  gap: 0.75rem;
  padding: 0.75rem 1rem;
  transition: all 0.2s ease;
  cursor: pointer;

  &:hover {
    background: var(--p-surface-hover);
  }

  .profession-icon-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 3rem;
    height: 3rem;
    border-radius: var(--p-border-radius-md);
    background: linear-gradient(135deg, var(--p-surface-100) 0%, var(--p-surface-200) 100%);
    border: 2px solid var(--p-surface-border);
    flex-shrink: 0;
    padding: 0.25rem;

    .profession-icon {
      width: 100%;
      height: 100%;
      object-fit: contain;
      image-rendering: crisp-edges;
    }
  }

  .profession-info {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    flex: 1;

    .profession-name {
      font-weight: 500;
      font-size: 0.875rem;
      color: var(--p-text-color);
    }

    .profession-description {
      font-size: 0.75rem;
      color: var(--p-text-color-secondary);
      line-height: 1.3;
    }
  }
}

// Selected professions display
.selected-professions {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  flex-wrap: wrap;
  padding: 0.25rem 0;

  .selected-profession-chip {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.375rem 0.75rem;
    background: var(--p-surface-100);
    border-radius: var(--p-border-radius-md);
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--p-text-color);
    border: 1px solid var(--p-surface-border);

    .profession-chip-icon {
      width: 1.5rem;
      height: 1.5rem;
      object-fit: contain;
      image-rendering: crisp-edges;
    }
  }

  .placeholder-text {
    color: var(--p-text-color-secondary);
    font-size: 0.875rem;
  }
}

// Dropdown panel styling
::ng-deep .p-multiselect-panel {
  .p-multiselect-items {
    .p-multiselect-item {
      padding: 0;

      &.p-highlight {
        background: var(--p-primary-50);

        .profession-option {
          background: transparent;
        }
      }

      &:not(.p-highlight):not(.p-disabled):hover {
        background: transparent;
      }
    }
  }

  .p-multiselect-empty-message {
    padding: 1rem;
    text-align: center;
    color: var(--p-text-color-secondary);
  }
}

// Responsive design
@media (max-width: 768px) {
  ::ng-deep .character-form-dialog {
    width: 95vw;
    min-width: 320px;

    .p-dialog-header {
      padding: 1rem;
    }
  }

  .character-form {
    padding: 1rem;
    gap: 1rem;

    .form-field {
      gap: 0.375rem;

      .field-label {
        font-size: 0.8125rem;
      }
    }

    .form-actions {
      flex-direction: column-reverse;
      gap: 0.5rem;

      ::ng-deep .p-button {
        width: 100%;
        justify-content: center;
      }
    }
  }
}

@media (max-width: 480px) {
  .character-form {
    padding: 0.75rem;

    .form-field {
      ::ng-deep {
        .p-dropdown-label,
        .p-multiselect-label {
          padding: 0.625rem;
          font-size: 0.875rem;
        }

        .p-inputtext {
          padding: 0.625rem;
          font-size: 0.875rem;
        }
      }
    }
  }
}

// Dark mode support
@media (prefers-color-scheme: dark) {
  .character-form {
    .form-loading {
      background: rgba(0, 0, 0, 0.9);
    }
  }
}